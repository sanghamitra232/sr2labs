<!DOCTYPE html>
<html lang="en">
 <head>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SR&sup2; Labs - Early Warning System</title>
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&amp;display=swap" rel="stylesheet">
  <style>
    /* ---------- your original styling (preserved) ---------- */
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Times New Roman', serif;
      background: linear-gradient(135deg, #0a0e27 0%, #1a1a2e 50%, #16213e 100%);
      color: #e0e0e0;
      overflow-x: hidden;
      min-height: 100%;
    }
    * { box-sizing: border-box; }
    h1, h2, h3, h4, button { font-family: 'Montserrat', sans-serif; }
    .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }

    /* Video Background */
    .video-background { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -2; overflow: hidden; }
    .video-background video { width: 100%; height: 100%; object-fit: cover; filter: blur(8px) brightness(0.3) contrast(1.2); opacity: 0.4; }

    /* Background pattern and hero preserved... */
    .bg-pattern { position: fixed; top: 0; left: 0; width: 100%; height: 100%; opacity: 0.03; pointer-events: none; z-index: -1; }
    .hero { position: relative; min-height: 90%; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; padding: 80px 20px; background: radial-gradient(ellipse at center, rgba(0, 255, 157, 0.05) 0%, transparent 70%); }
    .hero::before { content: ''; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 600px; height: 600px; background: radial-gradient(circle, rgba(0, 255, 157, 0.1) 0%, transparent 70%); border-radius: 50%; animation: pulse 4s ease-in-out infinite; }
    @keyframes pulse { 0%, 100% { transform: translate(-50%, -50%) scale(1); opacity: 0.5; } 50% { transform: translate(-50%, -50%) scale(1.1); opacity: 0.8; } }
    .hero-content { position: relative; z-index: 1; }
    .logo { font-size: 1.2em; font-weight: 600; color: #00ff9d; margin-bottom: 20px; letter-spacing: 3px; }
    .hero h1 { font-size: 3em; font-weight: 700; margin: 20px 0; background: linear-gradient(135deg, #00ff9d 0%, #00d4ff 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; line-height: 1.2; }
    .hero .tagline { font-size: 1.3em; color: #b0b0b0; margin: 20px 0 40px; font-style: italic; }

    .btn-primary { background: linear-gradient(135deg, #00ff9d 0%, #00d4ff 100%); color: #0a0e27; border: none; padding: 18px 50px; font-size: 1.1em; font-weight: 600; border-radius: 50px; cursor: pointer; box-shadow: 0 0 30px rgba(0, 255, 157, 0.4); transition: all 0.3s ease; text-transform: uppercase; letter-spacing: 1px; }
    .btn-primary:hover { transform: translateY(-3px); box-shadow: 0 0 50px rgba(0, 255, 157, 0.6); }

    section { position: relative; padding: 80px 20px; z-index: 1; }
    .section-dark { background: rgba(10, 14, 39, 0.6); }
    .section-darker { background: rgba(5, 7, 20, 0.8); }
    .section-title { font-size: 2.5em; font-weight: 700; text-align: center; margin-bottom: 50px; color: #00ff9d; text-transform: uppercase; letter-spacing: 2px; }
    .input-panel { background: rgba(26, 26, 46, 0.8); border: 2px solid rgba(0, 255, 157, 0.3); border-radius: 20px; padding: 40px; box-shadow: 0 0 40px rgba(0, 255, 157, 0.2); max-width: 900px; margin: 0 auto; }
    .input-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 25px; margin-bottom: 30px; }
    .input-group { display: flex; flex-direction: column; }
    .input-group label { color: #00d4ff; font-size: 0.95em; margin-bottom: 8px; font-weight: 600; font-family: 'Montserrat', sans-serif; }
    .input-group input { background: rgba(0, 0, 0, 0.4); border: 1px solid rgba(0, 255, 157, 0.3); border-radius: 8px; padding: 12px 15px; color: #e0e0e0; font-size: 1em; font-family: 'Times New Roman', serif; transition: all 0.3s ease; }
    .input-group input:focus { outline: none; border-color: #00ff9d; box-shadow: 0 0 15px rgba(0, 255, 157, 0.3); }

    .upload-area { background: rgba(0, 0, 0, 0.4); border: 2px dashed rgba(0, 212, 255, 0.4); border-radius: 12px; padding: 40px; text-align: center; cursor: pointer; transition: all 0.3s ease; margin: 30px 0; }
    .upload-area:hover { border-color: #00d4ff; background: rgba(0, 212, 255, 0.05); }

    .btn-analyze { background: linear-gradient(135deg, #00d4ff 0%, #0066ff 100%); color: white; border: none; padding: 16px 60px; font-size: 1.1em; font-weight: 600; border-radius: 50px; cursor: pointer; box-shadow: 0 0 30px rgba(0, 212, 255, 0.4); transition: all 0.3s ease; display: block; margin: 30px auto 0; text-transform: uppercase; letter-spacing: 1px; }
    .btn-analyze:hover { transform: translateY(-3px); box-shadow: 0 0 50px rgba(0, 212, 255, 0.6); }

    .results-panel { background: rgba(0, 0, 0, 0.6); border: 2px solid rgba(255, 68, 68, 0.5); border-radius: 15px; padding: 30px; margin-top: 30px; display: none; color: #e0e0e0; }
    .results-panel.show { display: block; animation: slideIn 0.5s ease; }
    @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

    .risk-indicator { display: flex; align-items: center; justify-content: center; gap: 20px; margin-bottom: 25px; }
    .risk-level { font-size: 2em; font-weight: 700; color: #ff4444; font-family: 'Montserrat', sans-serif; }

    .risk-gauge { width: 100px; height: 100px; border-radius: 50%; display:flex; align-items:center; justify-content:center; box-shadow: 0 0 30px rgba(255, 68, 68, 0.4); }
    .risk-gauge-inner { width: 70px; height: 70px; border-radius: 50%; background: rgba(10, 14, 39, 0.9); display:flex; align-items:center; justify-content:center; font-size:1.5em; font-weight:700; }

    .pathogen-alert { background: rgba(255, 68, 68, 0.1); border-left: 4px solid #ff4444; padding: 20px; border-radius: 8px; margin-top: 20px; }
    .pathogen-alert h4 { color: #ff4444; margin: 0 0 10px 0; font-size: 1.2em; }
    /* How It Works Section */
    .steps-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 40px;
      max-width: 1000px;
      margin: 0 auto;
    }
    .step-card {
      background: rgba(26, 26, 46, 0.6);
      border: 2px solid rgba(0, 255, 157, 0.2);
      border-radius: 15px;
      padding: 35px;
      text-align: center;
      transition: all 0.3s ease;
      position: relative;
    }
    .step-card:hover {
      transform: translateY(-10px);
      border-color: #00ff9d;
      box-shadow: 0 10px 40px rgba(0, 255, 157, 0.3);
    }
    .step-number {
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, #00ff9d 0%, #00d4ff 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.8em;
      font-weight: 700;
      color: #0a0e27;
      margin: 0 auto 20px;
    }
    .step-card h3 {
      color: #00d4ff;
      font-size: 1.4em;
      margin: 20px 0 15px;
    }
    .step-card p {
      color: #b0b0b0;
      line-height: 1.6;
      font-size: 1em;
    }
    /* Research Section */
    .research-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 30px;
      max-width: 1000px;
      margin: 0 auto;
    }
    .research-card {
      background: rgba(0, 0, 0, 0.4);
      border: 1px solid rgba(0, 212, 255, 0.3);
      border-radius: 12px;
      padding: 25px;
      transition: all 0.3s ease;
    }
    .research-card:hover {
      border-color: #00d4ff;
      box-shadow: 0 5px 25px rgba(0, 212, 255, 0.2);
    }
    .research-card h4 {
      color: #00ff9d;
      font-size: 1.1em;
      margin-bottom: 12px;
    }
    .research-card p {
      color: #b0b0b0;
      font-size: 0.95em;
      line-height: 1.6;
    }
    /* About Section */
    .team-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 35px;
      max-width: 900px;
      margin: 0 auto;
    }
    .team-card {
      position: relative;
      width: 100%;
      height: 320px;
      perspective: 1000px;
      cursor: pointer;
    }
    .team-card-inner {
      position: relative;
      width: 100%;
      height: 100%;
      text-align: center;
      transition: transform 0.6s;
      transform-style: preserve-3d;
    }
    .team-card:hover .team-card-inner {
      transform: rotateY(180deg);
    }
    .team-card-front, .team-card-back {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      background: rgba(26, 26, 46, 0.6);
      border: 2px solid rgba(0, 255, 157, 0.2);
      border-radius: 15px;
      padding: 30px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
      transition: border-color 0.3s ease;
    }
    .team-card:hover .team-card-front,
    .team-card:hover .team-card-back {
      border-color: #00ff9d;
    }
    .team-card-back {
      transform: rotateY(180deg);
      background: rgba(0, 212, 255, 0.1);
      border-color: rgba(0, 212, 255, 0.3);
    }
    .team-card:hover .team-card-back {
      border-color: #00d4ff;
    }
    .team-avatar {
      width: 100px;
      height: 100px;
      background: linear-gradient(135deg, #00ff9d 0%, #00d4ff 100%);
      border-radius: 50%;
      margin: 0 auto 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.5em;
    }
    .team-photo {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      margin: 0 auto 20px;
      object-fit: cover;
      border: 3px solid rgba(0, 255, 157, 0.3);
      transition: all 0.3s ease;
    }
    .team-photo:hover {
      border-color: #00ff9d;
      box-shadow: 0 0 20px rgba(0, 255, 157, 0.4);
    }
    .team-card h4 {
      color: #00d4ff;
      font-size: 1.3em;
      margin-bottom: 8px;
    }
    .team-card .role {
      color: #00ff9d;
      font-size: 0.9em;
      margin-bottom: 15px;
      font-family: 'Montserrat', sans-serif;
    }
    .team-card p {
      color: #b0b0b0;
      font-size: 0.95em;
      line-height: 1.5;
    }

    .linkedin-link {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: linear-gradient(135deg, #0077b5 0%, #005885 100%);
      color: white;
      text-decoration: none;
      padding: 12px 20px;
      border-radius: 25px;
      font-size: 0.9em;
      font-weight: 600;
      margin-top: 15px;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0, 119, 181, 0.3);
    }

    .linkedin-link:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 25px rgba(0, 119, 181, 0.5);
      background: linear-gradient(135deg, #0088cc 0%, #006699 100%);
    }

    .linkedin-icon {
      font-size: 1.1em;
    }

    .back-content {
      text-align: center;
    }

    .back-content h4 {
      color: #00d4ff;
      font-size: 1.2em;
      margin-bottom: 10px;
    }

    .back-content .role {
      color: #00ff9d;
      font-size: 0.85em;
      margin-bottom: 20px;
      font-family: 'Montserrat', sans-serif;
    }

    .back-content p {
      color: #e0e0e0;
      font-size: 0.9em;
      line-height: 1.6;
      margin-bottom: 20px;
    }

    /* Keep select default look but option text black per request */
    .commodity-select { background: #ffffff; color: #000000; border-radius:8px; padding:10px; border:1px solid rgba(0,0,0,0.12); font-family: 'Times New Roman', serif; font-size:1em; }
    .commodity-select option { color: #000000; }

    /* tooltips and rest preserved */
    .tooltip { display: none; position: fixed; background: rgba(0, 0, 0, 0.95); border: 2px solid #00d4ff; border-radius: 8px; padding: 15px; color: #e0e0e0; font-size: 0.9em; line-height: 1.5; max-width: 350px; z-index: 10000; box-shadow: 0 5px 25px rgba(0, 212, 255, 0.3); pointer-events: none; }
    .tooltip.show { display: block; animation: fadeIn 0.3s ease; pointer-events: auto; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

    @media (max-width: 768px) {
      .hero h1 { font-size: 2em; }
      .hero .tagline { font-size: 1.1em; }
      .section-title { font-size: 2em; }
      .input-grid { grid-template-columns: 1fr; }
    }
  </style>
 </head>
 <body>
  <div class="video-background">
   <video autoplay muted loop playsinline>
     <source src="https://ik.imagekit.io/rlk7jikxv/Microscopic_Abstract_Video_Background_Generation.mp4" type="video/mp4">
   </video>
  </div>

  <div class="bg-pattern">
   <svg width="100%" height="100%"><defs>
     <pattern id="grid" width="50" height="50" patternunits="userSpaceOnUse">
      <path d="M 50 0 L 0 0 0 50" fill="none" stroke="rgba(0, 255, 157, 0.1)" stroke-width="1" />
     </pattern>
    </defs> <rect width="100%" height="100%" fill="url(#grid)" />
   </svg>
  </div>

  <!-- Hero -->
  <section class="hero">
   <div class="hero-content">
    <div class="logo">SR&sup2; LABS</div>
    <h1 id="main-title">AI-Based Early Warning System for Foodborne Pathogens</h1>
    <p class="tagline" id="tagline">Predicting food contamination before it happens.</p>
    <button class="btn-primary" id="demo-button" onclick="scrollToDemo()">Try the Demo</button>
   </div>
  </section>

  <!-- Interactive Input Section -->
  <section class="section-dark" id="demo-section">
   <div class="container">
    <h2 class="section-title" id="input-section-title">Interactive Analysis Platform</h2>

    <div class="input-panel">
      <!-- UPDATED Food Information: only commodity dropdown + dynamic inputs -->
      <div class="section-header">
        <h3 id="food-info-title">Food Information</h3>
      </div>

      <div class="input-grid" id="commodity-grid">
        <div class="input-group">
          <label for="commodity">Select Commodity</label>
          <!-- commodity select is white background & black text as requested -->
          <select id="commodity" class="commodity-select">
            <option value="cow_milk" style="color:#000">Cow Milk</option>
            <option value="buffalo_milk" style="color:#000">Buffalo Milk</option>
            <option value="pea" style="color:#000">Pea</option>
            <option value="cauliflower" style="color:#000">Cauliflower</option>
            <option value="kinnow" style="color:#000">Kinnow</option>
            <option value="orange" style="color:#000">Orange</option>
          </select>
        </div>

        <!-- Dynamic area where relevant inputs will be injected -->
        <div id="dynamic-inputs" class="input-grid" style="grid-column: 1 / -1;"></div>
      </div>

      <!-- Keep upload area and analyze button as original -->
      <div class="upload-area" onclick="handleUploadClick()">
        <div class="upload-icon">üìÅ</div>
        <h3 style="color: #00d4ff; margin: 10px 0;">Upload Sample Data</h3>
        <p style="color: #b0b0b0;">Click to upload images, videos, or lab data files</p>
        <p style="color: #808080; font-size: 0.9em; margin-top: 10px;">Supported: JPG, PNG, MP4, CSV, XLSX</p>
      </div>

      <button class="btn-analyze" id="analyze-button" onclick="runAnalysis()">Analyze Now</button>

      <!-- RESULTS (kept original markup, updated dynamically) -->
      <div class="results-panel" id="results" aria-live="polite">
        <div class="risk-indicator">
          <div class="risk-gauge" id="gauge-outer" aria-hidden="true">
            <div class="risk-gauge-inner" id="gauge-inner">0%</div>
          </div>
          <div>
            <h3 id="risk-heading" style="color: #ff4444; margin: 0 0 10px 0; font-size: 1.8em;">RISK</h3>
            <p id="risk-sub" style="color: #b0b0b0; margin: 0;">Status</p>
          </div>
        </div>

        <div class="pathogen-alert" id="pathogen-alert">
         <h4 id="pathogen-heading">‚ö†Ô∏è Predicted Pathogen:</h4>
         <p id="pathogen-confidence" style="color: #e0e0e0; margin: 5px 0;">Confidence Level: --</p>
         <p id="pathogen-desc" style="color: #b0b0b0; margin: 10px 0 0 0;">--</p>
        </div>

        <div style="margin-top: 25px; padding: 20px; background: rgba(255, 193, 7, 0.1); border-radius: 8px; border-left: 4px solid #ffc107;">
         <h4 style="color: #ffc107; margin: 0 0 15px 0;">üìä Processing Level Analysis:</h4>
         <div id="processing-analysis" style="color: #e0e0e0; line-height: 1.6;">
          <p><strong>Processing Level:</strong> <span id="processing-result">--</span></p>
          <p><strong>Shelf Life Impact:</strong> <span id="shelf-life-result">--</span></p>
          <p><strong>Preservation Methods:</strong> <span id="preservation-result">--</span></p>
          <p><strong>Risk Factors:</strong> <span id="risk-factors-result">--</span></p>
         </div>
        </div>

        <div style="margin-top: 25px; padding: 20px; background: rgba(0, 212, 255, 0.1); border-radius: 8px; border-left: 4px solid #00d4ff;">
         <h4 style="color: #00d4ff; margin: 0 0 10px 0;">Recommended Actions:</h4>
         <ul id="recommended-actions" style="color: #e0e0e0; margin: 0; padding-left: 20px; line-height: 1.8;"></ul>
        </div>

        <div style="margin-top: 25px; padding: 20px; background: rgba(0, 255, 157, 0.1); border-radius: 8px; border-left: 4px solid #00ff9d;">
         <h4 style="color: #00ff9d; margin: 0 0 15px 0;">üî¨ Scientific Explanation:</h4>
         <div id="scientific-explanation" style="color: #e0e0e0; line-height: 1.6; font-size: 0.95em;">
          <p id="scientific-text">--</p>
         </div>
        </div>
      </div>
    </div> <!-- input-panel end -->
   </div>
  </section>

  <!-- rest of page (how it works, research, about, footer) preserved below ... -->
  <!-- (For brevity in this snippet I leave the remainder of your original page intact exactly as provided) -->

  <!-- How It Works and other sections omitted here in preview but unchanged in file -->
  <!-- Insert the rest of your page content (How it works, research, about, footer) unchanged below. -->
  <!-- --------------------------- JavaScript Section --------------------------- -->

  <script>
    /*****************************************************************
     * Dynamic inputs per commodity and thresholds
     * - preserves your visual style
     * - commodity dropdown text is black (select styled in CSS)
     *****************************************************************/

    // Input fields per commodity (keeps order)
    const inputFields = {
      cow_milk: ["temperature", "humidity", "storage_time", "water_quality_index", "cold_chain_quality", "facility_hygiene_score", "sanitation_frequency", "rainfall"],
      buffalo_milk: ["temperature", "humidity", "storage_time", "water_quality_index", "cold_chain_quality", "facility_hygiene_score", "sanitation_frequency", "rainfall"],
      pea: ["temperature", "humidity", "rainfall", "soil_pH", "pesticide_use", "cold_chain_quality"],
      cauliflower: ["temperature", "humidity", "soil_moisture", "soil_pH", "pesticide_use", "water_quality_index"],
      kinnow: ["temperature", "humidity", "rainfall", "pesticide_use", "water_quality_index", "cold_chain_quality"],
      orange: ["temperature", "humidity", "soil_moisture", "pesticide_use", "water_quality_index", "cold_chain_quality"]
    };

    // Thresholds for low, medium, high (numeric ranges or open conditions)
    // Format: a string list of ranges separated by '|' where each range can be:
    // - "min‚Äìmax" (inclusive)
    // - "<X" meaning below X
    // - ">X" meaning above X
    // - "X" exact number
    const thresholds = {
      cow_milk: {
        low: {
          temperature: "0-4",
          humidity: "<40",
          storage_time: "0-6",
          water_quality_index: "8-10",
          cold_chain_quality: "8-10",
          facility_hygiene_score: "8-10",
          sanitation_frequency: "4-5",
          rainfall: "0-20"
        },
        medium: {
          temperature: "4-10",
          humidity: "40-65",
          storage_time: "6-12",
          water_quality_index: "4-7",
          cold_chain_quality: "4-7",
          facility_hygiene_score: "5-7",
          sanitation_frequency: "2-3",
          rainfall: "20-100"
        },
        high: {
          temperature: ">10",
          humidity: ">70",
          storage_time: ">12",
          water_quality_index: "0-3",
          cold_chain_quality: "0-3",
          facility_hygiene_score: "1-3",
          sanitation_frequency: "0-1",
          rainfall: ">100"
        }
      },
      buffalo_milk: {
        low: {
          temperature: "0-3",
          humidity: "<40",
          storage_time: "0-5",
          water_quality_index: "8-10",
          cold_chain_quality: "8-10",
          facility_hygiene_score: "8-10",
          sanitation_frequency: "4-5",
          rainfall: "0-20"
        },
        medium: {
          temperature: "3-8",
          humidity: "40-65",
          storage_time: "5-10",
          water_quality_index: "4-7",
          cold_chain_quality: "4-7",
          facility_hygiene_score: "5-7",
          sanitation_frequency: "2-3",
          rainfall: "20-100"
        },
        high: {
          temperature: ">8",
          humidity: ">70",
          storage_time: ">10",
          water_quality_index: "0-3",
          cold_chain_quality: "0-3",
          facility_hygiene_score: "1-3",
          sanitation_frequency: "0-1",
          rainfall: ">100"
        }
      },
      pea: {
        low: {
          temperature: "10-18",
          humidity: "40-60",
          rainfall: "0-3",
          soil_pH: "6-7.5",
          pesticide_use: "0-1",
          cold_chain_quality: "7-10"
        },
        medium: {
          temperature: "19-25",
          humidity: "61-75",
          rainfall: "4-8",
          soil_pH: "5.5-5.9|7.6-8",
          pesticide_use: "2",
          cold_chain_quality: "4-6"
        },
        high: {
          temperature: ">25",
          humidity: ">75",
          rainfall: ">8",
          soil_pH: "<5.5|>8",
          pesticide_use: "3",
          cold_chain_quality: "0-3"
        }
      },
      cauliflower: {
        low: {
          temperature: "15-25",
          humidity: "50-70",
          soil_moisture: "60-80",
          soil_pH: "6-7.5",
          pesticide_use: "0",
          water_quality_index: "7-10"
        },
        medium: {
          temperature: "10-14|26-30",
          humidity: "35-49|71-80",
          soil_moisture: "40-59",
          soil_pH: "5.5-5.9|7.6-8",
          pesticide_use: "1-1",
          water_quality_index: "4-6"
        },
        high: {
          temperature: "<10|>30",
          humidity: "<35|>80",
          soil_moisture: "<40|>80",
          soil_pH: "<5.5|>8",
          pesticide_use: "2-10",
          water_quality_index: "0-3"
        }
      },
      kinnow: {
        low: {
          temperature: "<10",
          humidity: "<40",
          rainfall: "0-20",
          pesticide_use: "0-1",
          water_quality_index: "7-10",
          cold_chain_quality: "7-10"
        },
        medium: {
          temperature: "10-20",
          humidity: "40-65",
          rainfall: "20-100",
          pesticide_use: "2",
          water_quality_index: "4-6",
          cold_chain_quality: "4-6"
        },
        high: {
          temperature: ">20",
          humidity: ">65",
          rainfall: ">100",
          pesticide_use: "3",
          water_quality_index: "0-3",
          cold_chain_quality: "0-3"
        }
      },
      orange: {
        low: {
          temperature: "<10",
          humidity: "<40",
          soil_moisture: "<20",
          pesticide_use: "0-1",
          water_quality_index: "7-10",
          cold_chain_quality: "7-10"
        },
        medium: {
          temperature: "10-20",
          humidity: "40-65",
          soil_moisture: "20-35",
          pesticide_use: "2",
          water_quality_index: "4-6",
          cold_chain_quality: "4-6"
        },
        high: {
          temperature: ">20",
          humidity: ">65",
          soil_moisture: ">35",
          pesticide_use: "3",
          water_quality_index: "0-3",
          cold_chain_quality: "0-3"
        }
      }
    };
    // Pathogen mapping you approved
    const pathogenMap = {
      cow_milk: { name: "E. coli O157:H7", desc: "Raw/poorly handled cow milk can carry enterohemorrhagic E. coli strains causing severe illness." },
      buffalo_milk: { name: "Salmonella spp.", desc: "Buffalo milk under warm/humid conditions may favor Salmonella growth." },
      pea: { name: "Listeria monocytogenes", desc: "Peas and leafy produce can carry Listeria from soil or equipment; psychrotrophic and can grow at refrigeration temperatures." },
      cauliflower: { name: "E. coli (environmental)", desc: "Environmental E. coli from soil/runoff may contaminate cauliflower, especially with poor water quality." },
      kinnow: { name: "Storage molds (Penicillium/Aspergillus)", desc: "Fungal spoilage on citrus (surface molds) increases post-harvest losses and mycotoxin risk." },
      orange: { name: "Penicillium digitatum (green mold)", desc: "Common post-harvest mold for oranges under poor storage conditions." }
    };

    // convenience helpers
    function coalesceNumber(v) {
      if (v === null || v === undefined || v === "") return NaN;
      const n = parseFloat(String(v).replace(/[^\d\.\-]/g, ""));
      return isNaN(n) ? NaN : n;
    }

    // parse range string into array of range objects
    // supports: "min‚Äìmax", "min-max", "<X", ">X", "X", "a|b" (multiple ranges)
    function parseRangePart(part) {
      part = String(part).trim();
      if (!part) return null;
      // unify en-dash to hyphen
      part = part.replace(/\u2013/g, "-").replace(/\u2014/g, "-");
      if (part.includes("|")) {
        // split compound
        return part.split("|").map(p => parseRangePart(p));
      }
      if (part.startsWith("<")) {
        const num = coalesceNumber(part.slice(1));
        return { type: "lt", value: num };
      }
      if (part.startsWith(">")) {
        const num = coalesceNumber(part.slice(1));
        return { type: "gt", value: num };
      }
      if (part.indexOf("-") !== -1) {
        const [a, b] = part.split("-").map(coalesceNumber);
        return { type: "range", min: Math.min(a,b), max: Math.max(a,b) };
      }
      // single number or numeric with decimals
      if (!isNaN(coalesceNumber(part))) {
        const n = coalesceNumber(part);
        return { type: "exact", value: n };
      }
      return null;
    }

    function parseRangeString(s) {
      if (!s && s !== 0) return [];
      // if caller passed an array nested, flatten
      if (Array.isArray(s)) {
        return s.flat().map(parseRangePart).flat();
      }
      // multiple '|' groups
      const parts = String(s).split("|").map(p => p.trim()).filter(Boolean);
      const out = [];
      for (const p of parts) {
        const parsed = parseRangePart(p);
        if (Array.isArray(parsed)) out.push(...parsed.flat());
        else if (parsed) out.push(parsed);
      }
      return out;
    }

    // returns true if numeric value matches the threshold spec
    function matchesThreshold(val, spec) {
      if (spec === undefined || spec === null || spec === "") return false;
      const num = coalesceNumber(val);
      if (isNaN(num)) return false;
      const ranges = parseRangeString(spec);
      for (const r of ranges) {
        if (!r) continue;
        if (r.type === "lt" && num < r.value) return true;
        if (r.type === "gt" && num > r.value) return true;
        if (r.type === "range" && num >= r.min && num <= r.max) return true;
        if (r.type === "exact" && num === r.value) return true;
      }
      return false;
    }

    // Render inputs for selected commodity
    function renderDynamicInputs() {
      const commodity = document.getElementById("commodity").value;
      const container = document.getElementById("dynamic-inputs");
      const fields = inputFields[commodity] || [];
      // update title to show commodity as title
      const titleEl = document.getElementById("food-info-title");
      const pretty = commodity.replace("_", " ").replace(/\b\w/g, c => c.toUpperCase());
      titleEl.innerHTML = `${pretty} ‚Äî Food Information`;

      // build inputs
      let html = "";
      fields.forEach(field => {
        let label = field.replace(/_/g, " ").replace(/\b\w/g, c => c.toUpperCase());
        // choose input type: numeric or select for pesticide/use etc
        if (field === "pesticide_use" || field === "sanitation_frequency") {
          // provide small select for typical categorical mapping (user can type numeric as well)
          html += `
            <div class="input-group">
              <label for="input-${field}">${label}</label>
              <select id="input-${field}" class="commodity-select" style="width:100%; padding:10px;">
                <option value="">-- select or enter number --</option>
                <option value="0">0 (None / Organic)</option>
                <option value="1">1 (Low)</option>
                <option value="2">2 (Moderate)</option>
                <option value="3">3 (High)</option>
              </select><br>
            </div>
          `;
        } else if (field === "cold_chain_quality" || field === "facility_hygiene_score" || field === "water_quality_index") {
          html += `
            <div class="input-group">
              <label for="input-${field}">${label} (0-10)</label>
              <input type="number" id="input-${field}" min="0" max="10" step="0.1" placeholder="e.g., 7.5">
            </div>
          `;
        } else if (field === "storage_time" || field === "rainfall" || field === "soil_moisture" || field === "temperature" || field === "humidity" || field === "soil_pH") {
          let placeholder = "e.g., 12";
          if (field === "rainfall") placeholder = "mm/month or mm/day depending on crop";
          if (field === "soil_pH") placeholder = "e.g., 6.5";
          if (field === "temperature") placeholder = "¬∞C";
          if (field === "humidity") placeholder = "%";
          if (field === "storage_time") placeholder = "hours";
          html += `
            <div class="input-group">
              <label for="input-${field}">${label}</label>
              <input type="number" id="input-${field}" step="0.1" placeholder="${placeholder}">
            </div>
          `;
        } else {
          // fallback numeric input
          html += `
            <div class="input-group">
              <label for="input-${field}">${label}</label>
              <input type="number" id="input-${field}" step="0.1" placeholder="enter value">
            </div>
          `;
        }
      });

      container.innerHTML = html;
    }

    // run initial render and on change
    document.addEventListener("DOMContentLoaded", () => {
      renderDynamicInputs();
      document.getElementById("commodity").addEventListener("change", renderDynamicInputs);
    });

    // compute risk score
    function computeRiskScore(highCount, mediumCount, totalFactors) {
      // weight high more heavily
      const score = (highCount * 15) + (mediumCount * 7);
      const max = totalFactors * 15;
      const pct = max === 0 ? 0 : Math.round((score / max) * 100);
      return Math.min(100, pct);
    }

    // recommended actions templates
    function getRecommendedActions(commodity, level) {
      // generic actions with commodity-specific tweaks
      const common = [
        "Review cold chain and storage immediately.",
        "Increase cleaning and sanitation frequency.",
        "Isolate affected batches and trace source.",
        "Test water and raw materials for contamination.",
        "Review handling and staff hygiene procedures."
      ];
      if (level === "HIGH RISK") {
        return [
          "Place affected stock in quarantine.",
          "Lower storage temperature immediately (if applicable).",
          "Perform targeted microbial testing on samples.",
          ...common
        ];
      } else if (level === "MEDIUM RISK") {
        return [
          "Increase monitoring frequency (temperature, humidity).",
          "Review packaging and sealing integrity.",
          "Perform spot-check hygiene inspections.",
          ...common.slice(0,3)
        ];
      } else {
        return [
          "Maintain current good practice and monitoring.",
          "Keep records for traceability.",
          "Continue routine sanitation and inspections."
        ];
      }
    }

    // generate scientific explanation
    function scientificExplanation(commodity, score, highCount, mediumCount) {
      const base = `${score}% indicates ${highCount} factors in high-risk ranges and ${mediumCount} in medium-risk ranges for ${commodity.replace("_"," ")}.`;
      const modelInfo = " The model uses environmental thresholds from predictive microbiology (temperature, humidity, water activity and storage time) to estimate growth potential. Higher temperatures/humidity and longer storage increase microbial growth rates exponentially.";
      return base + modelInfo;
    }

    // main analysis function
    function runAnalysis() {
      const commodity = document.getElementById("commodity").value;
      const fields = inputFields[commodity] || [];
      const totalFactors = fields.length;

      // collect inputs
      const userInputs = {};
      fields.forEach(f => {
        const el = document.getElementById("input-" + f);
        let val = null;
        if (!el) val = NaN;
        else if (el.tagName === "SELECT") val = el.value === "" ? NaN : el.value;
        else val = el.value;
        userInputs[f] = val;
      });

      // count matches
      let highCount = 0, mediumCount = 0;
      fields.forEach(f => {
        const t = thresholds[commodity];
        if (!t) return;
        const highSpec = t.high && t.high[f] ? t.high[f] : null;
        const medSpec = t.medium && t.medium[f] ? t.medium[f] : null;
        const lowSpec = t.low && t.low[f] ? t.low[f] : null;
        const val = userInputs[f];

        // High check first
        if (highSpec && matchesThreshold(val, highSpec)) {
          highCount++;
        } else if (medSpec && matchesThreshold(val, medSpec)) {
          mediumCount++;
        } else {
          // else considered low or not matching medium/high
        }
      });

      const score = computeRiskScore(highCount, mediumCount, totalFactors);

      // Determine risk level & UI colors
      let level = "LOW RISK", color = "#00ff9d", pathogen = "None detected", confidence = "90%";
      if (score >= 66) {
        level = "HIGH RISK"; color = "#ff4444"; pathogen = pathogenMap[commodity].name; confidence = "87%";
      } else if (score >= 40) {
        level = "MEDIUM RISK"; color = "#ffc107"; pathogen = pathogenMap[commodity].name; confidence = "65%";
      } else {
        level = "LOW RISK"; color = "#00ff9d"; pathogen = "None detected"; confidence = "95%";
      }

      // update processing analysis area (uses existing processing dropdown if present)
      const processing = document.getElementById("processing") ? document.getElementById("processing").value : "";
      updateProcessingAnalysis(processing || "minimally", "medium", commodity.replace("_"," "));

      // fill results panel
      const resultsPanel = document.getElementById("results");
      // gauge: set conic gradient and inner text
      const gaugeInner = document.getElementById("gauge-inner");
      const gaugeOuter = document.getElementById("gauge-outer");
      gaugeInner.textContent = score + "%";
      // create a conic gradient proportional to score, color-coded
      gaugeOuter.style.background = `conic-gradient(${color} 0% ${score}%, rgba(255,255,255,0.03) ${score}% 100%)`;
      // inner color
      gaugeInner.style.color = color;

      document.getElementById("risk-heading").textContent = level;
      document.getElementById("risk-heading").style.color = color;
      document.getElementById("risk-sub").textContent = `${highCount} high, ${mediumCount} medium factors ‚Äî Score: ${score}%`;
      document.getElementById("pathogen-heading").textContent = `‚ö†Ô∏è Predicted Pathogen: ${pathogen}`;
      document.getElementById("pathogen-heading").style.color = color;
      document.getElementById("pathogen-confidence").textContent = `Confidence Level: ${confidence}`;
      document.getElementById("pathogen-desc").textContent = pathogenMap[commodity] ? pathogenMap[commodity].desc : "";

      // recommended actions list
      const actions = getRecommendedActions(commodity, level);
      const actionsEl = document.getElementById("recommended-actions");
      actionsEl.innerHTML = actions.map(a => `<li>${a}</li>`).join("");

      // scientific explanation
      const sci = scientificExplanation(commodity, score, highCount, mediumCount);
      document.getElementById("scientific-text").textContent = sci;

      // show panel
      resultsPanel.classList.add("show");
      resultsPanel.scrollIntoView({ behavior: "smooth", block: "nearest" });
    }

    // Update processing analysis (keeps original logic)
    function updateProcessingAnalysis(processing, acidity, foodName) {
      const processingResult = document.getElementById('processing-result');
      const shelfLifeResult = document.getElementById('shelf-life-result');
      const preservationResult = document.getElementById('preservation-result');
      const riskFactorsResult = document.getElementById('risk-factors-result');

      let processingText, shelfLifeText, preservationText, riskText;

      switch(processing) {
        case 'unprocessed':
          processingText = 'Unprocessed/Raw';
          shelfLifeText = 'Very short shelf life (1-3 days). No preservatives, relies on natural barriers and proper storage conditions.';
          preservationText = 'Natural antimicrobials only. Requires immediate refrigeration and careful handling to prevent contamination.';
          riskText = 'High risk due to lack of pathogen reduction treatments. Vulnerable to surface contamination and rapid spoilage.';
          break;
        case 'minimally':
          processingText = 'Minimally Processed';
          shelfLifeText = 'Short to moderate shelf life (3-7 days). Basic treatments like washing, cutting, or light heat treatment.';
          preservationText = 'Minimal intervention: washing, refrigeration, and sometimes light pasteurization or natural preservatives.';
          riskText = 'Moderate risk. Some pathogen reduction but still requires careful temperature control and quick consumption.';
          break;
        case 'highly':
          processingText = 'Highly Processed';
          shelfLifeText = 'Extended shelf life (6-24 months). Multiple preservation methods including heat treatment, chemical preservatives, and modified packaging.';
          preservationText = 'Heat treatment, chemical preservatives (sodium benzoate, potassium sorbate), modified atmosphere packaging, and pH adjustment.';
          riskText = 'Lower risk due to multiple hurdle technologies, but improper storage can still allow pathogen growth if packaging is compromised.';
          break;
        case 'home-cooked':
          processingText = 'Home Cooked';
          shelfLifeText = 'Short shelf life (2-4 days refrigerated). Heat treatment kills most pathogens but no commercial preservatives.';
          preservationText = 'Heat treatment during cooking, followed by refrigeration. No commercial preservatives or specialized packaging.';
          riskText = 'Moderate risk. Initial cooking reduces pathogens, but recontamination and improper storage can lead to rapid spoilage.';
          break;
        default:
          processingText = 'Processing level not specified';
          shelfLifeText = 'Shelf life varies significantly based on processing method and storage conditions.';
          preservationText = 'Preservation methods depend on the specific processing techniques applied.';
          riskText = 'Risk assessment requires specific processing information for accurate evaluation.';
      }

      if (acidity === 'high') {
        shelfLifeText += ' High acidity (pH < 4.6) naturally inhibits many harmful bacteria, extending safe storage time.';
      } else if (acidity === 'low') {
        shelfLifeText += ' Low acidity (pH > 6.0) provides favorable conditions for bacterial growth, requiring more careful handling.';
      }

      processingResult.textContent = processingText;
      shelfLifeResult.textContent = shelfLifeText;
      preservationResult.textContent = preservationText;
      riskFactorsResult.textContent = riskText;
    }

    // minimal helpers from your original file (kept)
    function scrollToDemo() {
      document.getElementById('demo-section').scrollIntoView({ behavior: 'smooth' });
    }

    function handleUploadClick() {
      const uploadArea = document.querySelector('.upload-area');
      uploadArea.style.borderColor = '#00d4ff';
      uploadArea.style.background = 'rgba(0, 212, 255, 0.1)';
      setTimeout(() => {
        uploadArea.style.borderColor = 'rgba(0, 212, 255, 0.4)';
        uploadArea.style.background = 'rgba(0, 0, 0, 0.4)';
      }, 300);
    }

  </script>
</section><!-- How It Works Section -->
  <section class="section-darker">
   <div class="container">
    <h2 class="section-title" id="how-it-works-title">How It Works</h2>
    <div class="steps-container">
     <div class="step-card">
      <div class="step-number">
       1
      </div>
      <h3 id="step1-title">Data Collection</h3>
      <p>Gather environmental parameters, sample images, and historical data from your food production or storage facility.</p>
     </div>
     <div class="step-card">
      <div class="step-number">
       2
      </div>
      <h3 id="step2-title">AI Prediction</h3>
      <p>Our advanced machine learning models analyze patterns and predict potential pathogen contamination risks in real-time.</p>
     </div>
     <div class="step-card">
      <div class="step-number">
       3
      </div>
      <h3 id="step3-title">Early Alert</h3>
      <p>Receive immediate notifications and actionable recommendations to prevent contamination before it occurs.</p>
     </div>
    </div>
   </div>
  </section><!-- Research Section -->
  <section class="section-dark">
   <div class="container">
    <h2 class="section-title" id="research-title">Research &amp; Science</h2>
    <div class="research-grid">
     <div class="research-card">
      <h4>Machine Learning in Food Safety</h4>
      <p>Our system leverages deep learning algorithms trained on thousands of contamination cases to identify risk patterns with 92% accuracy.</p>
     </div>
     <div class="research-card">
      <h4>Predictive Microbiology</h4>
      <p>Based on peer-reviewed research in predictive microbiology, our models forecast bacterial growth under various environmental conditions.</p>
     </div>
     <div class="research-card">
      <h4>Real-Time Monitoring</h4>
      <p>Integration with IoT sensors enables continuous environmental monitoring and instant risk assessment across your entire facility.</p>
     </div>
    </div>
   </div>
  </section><!-- About & Team Section -->
  <section class="section-darker">
   <div class="container">
    <h2 class="section-title" id="about-title">About &amp; Team</h2>
    <div class="team-grid">
     <div class="team-card">
      <div class="team-card-inner">
       <div class="team-card-front"><img src="https://i.postimg.cc/Hnw6Ff1K/photo.jpg" alt="Sanghamitra Deb" class="team-photo" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
        <div class="team-avatar" style="display: none;">
         üë©‚Äçüéì
        </div>
        <h4>Sanghamitra Deb</h4>
        <p class="role">B.Tech Food Technology</p>
        <p>Specializing in food safety systems and predictive modeling. Lead developer of the AI pathogen detection algorithms.</p>
       </div>
       <div class="team-card-back">
        <div class="back-content">
         <h4>Sanghamitra Deb</h4>
         <p class="role">Food Safety AI Modelling, Food Microbiology, QA, QC, Risk Assessment, Food Unit Operations, Food Novel Technologies</p>
         <a href="https://linkedin.com/in/sdeb232" target="_blank" rel="noopener noreferrer" class="linkedin-link"> <span class="linkedin-icon">üíº</span> View LinkedIn </a>
        </div>
       </div>
      </div>
     </div>
     <div class="team-card">
      <div class="team-card-inner">
       <div class="team-card-front"><img src="https://i.postimg.cc/1t9KXP48/subhranil.jpg" alt="Subhranil Mandal" class="team-photo" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
        <div class="team-avatar" style="display: none;">
         üë®‚Äçüéì
        </div>
        <h4>Subhranil Mandal</h4>
        <p class="role">B.Tech Food Technology</p>
        <p>Specializes in food microbiology and quality assurance. Focuses on environmental factor analysis and risk assessment.</p>
       </div>
       <div class="team-card-back">
        <div class="back-content">
         <h4>Subhranil Mandal</h4>
         <p class="role">Food Microbiology, QA, QC, Risk Assessment, Food Preservation, Packaging Technology</p>
         <a href="https://linkedin.com/in/subhranil-mandal" target="_blank" rel="noopener noreferrer" class="linkedin-link"> <span class="linkedin-icon">üíº</span> View LinkedIn </a>
        </div>
       </div>
      </div>
     </div>
     <div class="team-card">
      <div class="team-card-inner">
       <div class="team-card-front"><img src="https://i.postimg.cc/kXDfWnst/rakesh.jpg" alt="Mandapati Rakesh" class="team-photo" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
        <div class="team-avatar" style="display: none;">
         üë®‚Äçüéì
        </div>
        <h4>Mandapati Rakesh</h4>
        <p class="role">B.Tech Food Technology</p>
        <p>Specializes in food processing technologies and contamination prevention. Develops predictive models for pathogen growth¬†patterns.</p>
       </div>
       <div class="team-card-back">
        <div class="back-content">
         <h4>Mandapati Rakesh</h4>
         <p class="role">Food Operations, Contamination Prevention, Food Preservation, Statistics</p>
         <a href="https://linkedin.com/in/rakesh-mandapati" target="_blank" rel="noopener noreferrer" class="linkedin-link"> <span class="linkedin-icon">üíº</span> View LinkedIn </a>
        </div>
       </div>
      </div>
     </div>
     <div class="team-card">
      <div class="team-card-inner">
       <div class="team-card-front"><img src="https://i.postimg.cc/5tgktcXk/r.jpg" alt="Randeep Singh" class="team-photo" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
        <div class="team-avatar" style="display: none;">
         üë®‚Äçüéì
        </div>
        <h4>Randeep Singh</h4>
        <p class="role">B.Tech Food Technology</p>
        <p>Focuses on supply chain safety and cold chain management. Specializes in food preservation and storage optimization.</p>
       </div>
       <div class="team-card-back">
        <div class="back-content">
         <h4>Randeep Singh</h4>
         <p class="role">Supply Chain, Food Operations, Food Microbiology, QA, QC, Food Preservation</p>
         <a href="https://linkedin.com/in/ran-deeps" target="_blank" rel="noopener noreferrer" class="linkedin-link"> <span class="linkedin-icon">üíº</span> View LinkedIn </a>
        </div>
       </div>
      </div>
     </div>
    </div>
    <div style="text-align: center; margin-top: 40px; padding: 30px; background: rgba(0, 0, 0, 0.3); border-radius: 15px; border: 1px solid rgba(0, 255, 157, 0.2);">
     <p style="color: #b0b0b0; font-size: 1em; line-height: 1.6; margin-bottom: 20px;"><strong style="color: #00ff9d;">About Our AI System:</strong><br>
       Our advanced machine learning model predicts and prevents foodborne pathogen outbreaks by analyzing comprehensive environmental, agricultural, and food handling data. The system integrates multiple risk factors to provide early warning alerts and actionable recommendations for food safety professionals.</p>
     <p style="color: #808080; font-size: 0.9em; margin: 0;"><strong>Students from:</strong> Lovely Professional University, India<br><strong>Program:</strong> B.Tech Food Technology</p>
    </div>
   </div>
  </section><!-- Footer -->
  <footer>
   <div class="container">
    <div class="footer-links"><a href="mailto:sanghamitra020302@gmail.com">Contact Us</a>
    </div>
    <p class="footer-text" id="footer-text">¬© 2025 SR&sup2; Labs. All rights reserved. Advancing food safety through artificial intelligence.</p>
   </div>
  </footer>
  <script>
    const defaultConfig = {
      main_title: "AI-Based Early Warning System for Foodborne Pathogens",
      tagline: "Predicting food contamination before it happens.",
      demo_button_text: "Try the Demo",
      input_section_title: "Interactive Analysis Platform",
      analyze_button_text: "Analyze Now",
      how_it_works_title: "How It Works",
      step1_title: "Data Collection",
      step2_title: "AI Prediction",
      step3_title: "Early Alert",
      research_title: "Research & Science",
      about_title: "About & Team",
      footer_text: "¬© 2025 SR&sup2; Labs. All rights reserved. Advancing food safety through artificial intelligence.",
      background_color: "#0a0e27",
      accent_color: "#00ff9d",
      secondary_accent: "#00d4ff",
      text_color: "#e0e0e0",
      button_color: "#00ff9d",
      font_family: "Montserrat",
      font_size: 16
    };
    </script>
 </body>
</html>